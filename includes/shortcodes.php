<?php

function check_old_fa($icon) {
	if ($icon == "ban-circle"){$icon = "ban";}
	if ($icon == "bar-chart"){$icon = "bar-chart-o";}
	if ($icon == "beaker"){$icon = "flask";}
	if ($icon == "bell"){$icon = "bell-o";}
	if ($icon == "bell-alt"){$icon = "bell";}
	if ($icon == "bitbucket-sign"){$icon = "bitbucket-square";}
	if ($icon == "bookmark-empty"){$icon = "bookmark-o";}
	if ($icon == "building"){$icon = "building-o";}
	if ($icon == "calendar-empty"){$icon = "calendar-o";}
	if ($icon == "check-empty"){$icon = "square-o";}
	if ($icon == "check-minus"){$icon = "minus-square-o";}
	if ($icon == "check-sign"){$icon = "check-square";}
	if ($icon == "check"){$icon = "check-square-o";}
	if ($icon == "chevron-sign-down"){$icon = "chevron-down";}
	if ($icon == "chevron-sign-left"){$icon = "chevron-left";}
	if ($icon == "chevron-sign-right"){$icon = "chevron-right";}
	if ($icon == "chevron-sign-up"){$icon = "chevron-up";}
	if ($icon == "circle-arrow-down"){$icon = "arrow-circle-down";}
	if ($icon == "circle-arrow-left"){$icon = "arrow-circle-left";}
	if ($icon == "circle-arrow-right"){$icon = "arrow-circle-right";}
	if ($icon == "circle-arrow-up"){$icon = "arrow-circle-up";}
	if ($icon == "circle-blank"){$icon = "circle-o";}
	if ($icon == "cny"){$icon = "rmb";}
	if ($icon == "collapse-alt"){$icon = "minus-square-o";}
	if ($icon == "collapse-top"){$icon = "caret-square-o-up";}
	if ($icon == "collapse"){$icon = "caret-square-o-down";}
	if ($icon == "comment-alt"){$icon = "comment-o";}
	if ($icon == "comments-alt"){$icon = "comments-o";}
	if ($icon == "copy"){$icon = "files-o";}
	if ($icon == "cut"){$icon = "scissors";}
	if ($icon == "dashboard"){$icon = "tachometer";}
	if ($icon == "double-angle-down"){$icon = "angle-double-down";}
	if ($icon == "double-angle-left"){$icon = "angle-double-left";}
	if ($icon == "double-angle-right"){$icon = "angle-double-right";}
	if ($icon == "double-angle-up"){$icon = "angle-double-up";}
	if ($icon == "download"){$icon = "arrow-circle-o-down";}
	if ($icon == "download-alt"){$icon = "download";}
	if ($icon == "edit-sign"){$icon = "pencil-square";}
	if ($icon == "edit"){$icon = "pencil-square-o";}
	if ($icon == "ellipsis-horizontal"){$icon = "ellipsis-h";}
	if ($icon == "ellipsis-vertical"){$icon = "ellipsis-v";}
	if ($icon == "envelope-alt"){$icon = "envelope-o";}
	if ($icon == "exclamation-sign"){$icon = "exclamation-circle";}
	if ($icon == "expand-alt"){$icon = "plus-square-o";}
	if ($icon == "expand"){$icon = "caret-square-o-right";}
	if ($icon == "external-link-sign"){$icon = "external-link-square";}
	if ($icon == "eye-close"){$icon = "eye-slash";}
	if ($icon == "eye-open"){$icon = "eye";}
	if ($icon == "facebook-sign"){$icon = "facebook-square";}
	if ($icon == "facetime-video"){$icon = "video-camera";}
	if ($icon == "file-alt"){$icon = "file-o";}
	if ($icon == "file-text-alt"){$icon = "file-text-o";}
	if ($icon == "flag-alt"){$icon = "flag-o";}
	if ($icon == "folder-close-alt"){$icon = "folder-o";}
	if ($icon == "folder-close"){$icon = "folder";}
	if ($icon == "folder-open-alt"){$icon = "folder-open-o";}
	if ($icon == "food"){$icon = "cutlery";}
	if ($icon == "frown"){$icon = "frown-o";}
	if ($icon == "fullscreen"){$icon = "arrows-alt";}
	if ($icon == "github-sign"){$icon = "github-square";}
	if ($icon == "google-plus-sign"){$icon = "google-plus-square";}
	if ($icon == "group"){$icon = "users";}
	if ($icon == "h-sign"){$icon = "h-square";}
	if ($icon == "hand-down"){$icon = "hand-o-down";}
	if ($icon == "hand-left"){$icon = "hand-o-left";}
	if ($icon == "hand-right"){$icon = "hand-o-right";}
	if ($icon == "hand-up"){$icon = "hand-o-up";}
	if ($icon == "hdd"){$icon = "hdd-o (4.0.1)";}
	if ($icon == "heart-empty"){$icon = "heart-o";}
	if ($icon == "hospital"){$icon = "hospital-o";}
	if ($icon == "indent-left"){$icon = "outdent";}
	if ($icon == "indent-right"){$icon = "indent";}
	if ($icon == "info-sign"){$icon = "info-circle";}
	if ($icon == "keyboard"){$icon = "keyboard-o";}
	if ($icon == "legal"){$icon = "gavel";}
	if ($icon == "lemon"){$icon = "lemon-o";}
	if ($icon == "lightbulb"){$icon = "lightbulb-o";}
	if ($icon == "linkedin-sign"){$icon = "linkedin-square";}
	if ($icon == "meh"){$icon = "meh-o";}
	if ($icon == "microphone-off"){$icon = "microphone-slash";}
	if ($icon == "minus-sign-alt"){$icon = "minus-square";}
	if ($icon == "minus-sign"){$icon = "minus-circle";}
	if ($icon == "mobile-phone"){$icon = "mobile";}
	if ($icon == "moon"){$icon = "moon-o";}
	if ($icon == "move"){$icon = "arrows";}
	if ($icon == "off"){$icon = "power-off";}
	if ($icon == "ok-circle"){$icon = "check-circle-o";}
	if ($icon == "ok-sign"){$icon = "check-circle";}
	if ($icon == "ok"){$icon = "check";}
	if ($icon == "paper-clip"){$icon = "paperclip";}
	if ($icon == "paste"){$icon = "clipboard";}
	if ($icon == "phone-sign"){$icon = "phone-square";}
	if ($icon == "picture"){$icon = "picture-o";}
	if ($icon == "pinterest-sign"){$icon = "pinterest-square";}
	if ($icon == "play-circle"){$icon = "play-circle-o";}
	if ($icon == "play-sign"){$icon = "play-circle";}
	if ($icon == "plus-sign-alt"){$icon = "plus-square";}
	if ($icon == "plus-sign"){$icon = "plus-circle";}
	if ($icon == "pushpin"){$icon = "thumb-tack";}
	if ($icon == "question-sign"){$icon = "question-circle";}
	if ($icon == "remove-circle"){$icon = "times-circle-o";}
	if ($icon == "remove-sign"){$icon = "times-circle";}
	if ($icon == "remove"){$icon = "times";}
	if ($icon == "reorder"){$icon = "bars";}
	if ($icon == "resize-full"){$icon = "expand";}
	if ($icon == "resize-horizontal"){$icon = "arrows-h";}
	if ($icon == "resize-small"){$icon = "compress";}
	if ($icon == "resize-vertical"){$icon = "arrows-v";}
	if ($icon == "rss-sign"){$icon = "rss-square";}
	if ($icon == "save"){$icon = "floppy-o";}
	if ($icon == "screenshot"){$icon = "crosshairs";}
	if ($icon == "share-alt"){$icon = "share";}
	if ($icon == "share-sign"){$icon = "share-square";}
	if ($icon == "share"){$icon = "share-square-o";}
	if ($icon == "sign-blank"){$icon = "square";}
	if ($icon == "signin"){$icon = "sign-in";}
	if ($icon == "signout"){$icon = "sign-out";}
	if ($icon == "smile"){$icon = "smile-o";}
	if ($icon == "sort-by-alphabet-alt"){$icon = "sort-alpha-desc";}
	if ($icon == "sort-by-alphabet"){$icon = "sort-alpha-asc";}
	if ($icon == "sort-by-attributes-alt"){$icon = "sort-amount-desc";}
	if ($icon == "sort-by-attributes"){$icon = "sort-amount-asc";}
	if ($icon == "sort-by-order-alt"){$icon = "sort-numeric-desc";}
	if ($icon == "sort-by-order"){$icon = "sort-numeric-asc";}
	if ($icon == "sort-down"){$icon = "sort-desc";}
	if ($icon == "sort-up"){$icon = "sort-asc";}
	if ($icon == "stackexchange"){$icon = "stack-overflow";}
	if ($icon == "star-empty"){$icon = "star-o";}
	if ($icon == "star-half-empty"){$icon = "star-half-o";}
	if ($icon == "sun"){$icon = "sun-o";}
	if ($icon == "thumbs-down-alt"){$icon = "thumbs-o-down";}
	if ($icon == "thumbs-up-alt"){$icon = "thumbs-o-up";}
	if ($icon == "time"){$icon = "clock-o";}
	if ($icon == "trash"){$icon = "trash-o";}
	if ($icon == "tumblr-sign"){$icon = "tumblr-square";}
	if ($icon == "twitter-sign"){$icon = "twitter-square";}
	if ($icon == "unlink"){$icon = "chain-broken";}
	if ($icon == "upload"){$icon = "arrow-circle-o-up";}
	if ($icon == "upload-alt"){$icon = "upload";}
	if ($icon == "warning-sign"){$icon = "exclamation-triangle";}
	if ($icon == "xing-sign"){$icon = "xing-square";}
	if ($icon == "youtube-sign"){$icon = "youtube-square";}
	if ($icon == "zoom-in"){$icon = "search-plus";}
	if ($icon == "zoom-out"){$icon = "search-minus";}
	
	return $icon;
}

/* Button */

function themedy_shortcodes_button($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'url' => '', 
		'icon' => '',
		'font_awesome_att' => '',
		'label' => '', 
		'colour' => '', 
		'colour_custom' => '', 
		'size' => 'medium', 
		'edge' => 'straight', 
		'target' => '_self'
	), $atts));

	$icon = check_old_fa($icon);
	
	/* Return Button */
	$button_style = "";
	if($colour_custom) {
		$button_style = ' style="background-color: '.$colour_custom.'"';
	}
	if($icon) {
		$icon = '<i class="fa '.$font_awesome_att.' fa-'.$icon.'"></i>&nbsp;&nbsp;';
	}
	return '<a href="'.$url.'" class="themedy-shortcode themedy-shortcode-button themedy-shortcode-button-colour-'.$colour.' themedy-shortcode-button-size-'.$size.' themedy-shortcode-button-edge-'.$edge.'" target="'.$target.'"'.$button_style.'>'.$icon.$label.'</a>';
	
}
add_shortcode('themedy_button', 'themedy_shortcodes_button');


/* Columns */

function themedy_shortcodes_columns($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'structure' => '50|50'
	), $atts));
	
	$structure_class = str_replace('|', '-', $structure);
	$structure_class = str_replace('50', 'half', $structure_class);
	$structure_class = str_replace('33', 'third', $structure_class);
	$structure_class = str_replace('67', 'twothirds', $structure_class);
	$structure_class = str_replace('25', 'quarter', $structure_class);
	
	$structure_class = ' themedy-shortcode-cols-'.$structure_class.' ';

	/* Return Columns */
	return '<div class="themedy-shortcode themedy-shortcode-cols '.$structure_class.'">'.do_shortcode($content).'</div>';
	 
}
add_shortcode('themedy_columns', 'themedy_shortcodes_columns');



/* Column */

function themedy_shortcodes_column($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'position' => 'a'
	), $atts));
	
	return '<div class="themedy-shortcode themedy-shortcode-col themedy-shortcode-col-'.$position.'"><div class="themedy-shortcode-col-inner">'.wpautop(do_shortcode($content)).'</div></div>';

}
add_shortcode('themedy_col', 'themedy_shortcodes_column');



/* Social */

function themedy_social($atts, $content = null) {
	
	/* Return Social */
	return '<p class="themedy-shortcode themedy-shortcode-social-links">'.do_shortcode($content).'</p>';
	 
}
add_shortcode('themedy_social', 'themedy_social');



/* Social Link */

function themedy_social_link($atts, $content = null) {
	global $ja_themedy_shortcodes_directory;
	
	/* Set up variables */
	extract(shortcode_atts(array(
		'service' => '',
		'link' => ''
	), $atts));
	
	if(strpos($service, 'ja-social-icon-') !== false) {
		
		$social_link_code = '<a href="'.$link.'" target="_blank" class="ja-social-icon '.$service.'"></a>';
		
	} else {
		
		$social_link_code = '<a href="'.$link.'" target="_blank" class="ja-social-icon-image"><img src="'.$ja_themedy_shortcodes_directory.'images/social-icons/'.$service.'.png" alt="'.$service.'" /></a>';
		
	}

	/* Return Social */
	return $social_link_code;
	 
}
add_shortcode('themedy_social_link', 'themedy_social_link');



/* YouTube */

function themedy_shortcodes_media($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'type' => 'youtube',
		'url' => '',
		'width' => '',
		'height' => ''
	), $atts));
	
	$media_code = '';
	
	if($type == "youtube") {
	
	/* YouTube */
		if(strpos($url, 'youtube')) {
			$embed_src = $url;
			parse_str( parse_url( $embed_src, PHP_URL_QUERY ), $my_array_of_vars );
			$youtube_id = $my_array_of_vars['v']; 
		} else {
			$youtube_id = $url;
		}
		$media_code = '<div class="themedy-shortcode themedy-shortcode-video-embed"><iframe width="'.$width.'" height="'.$height.'" src="//www.youtube.com/embed/'.$youtube_id.'" frameborder="0" allowfullscreen></iframe></div>'; 
		
	} else if($type == "vimeo") {
	
	/* Vimeo */
		$result = preg_match('/(\d+)/', $url, $matches);
		if($result) {
		    $vimeo_id = $matches[0];
		} else {
			$vimeo_id = $url;
		}
		$media_code = '<div class="themedy-shortcode themedy-shortcode-video-embed"><iframe src="//player.vimeo.com/video/'.$vimeo_id.'" width="'.$width.'" height="'.$height.'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></div>'; 
	
	}
	
	return $media_code;

}
add_shortcode('themedy_media', 'themedy_shortcodes_media');



/* Toggles */

function themedy_shortcodes_toggle($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'heading' => '',
		'icon' => '',
		'font_awesome_att' => '',
		'accordion' => '',
		'onload' => 'closed'
	), $atts));

	$icon = check_old_fa($icon);

	if($onload == "open") { $active_class = "themedy-shortcode-toggle-active"; } else { $active_class = ""; }
	if($icon) { $icon_code = '<i class="fa '.$font_awesome_att.' fa-'.$icon.'"></i>'; } else { $icon_code = ''; }
	if($accordion == 1) {
		$toggle_icons = '<i class="toggle-down fa fa-plus"></i><i class="toggle-up fa fa-minus"></i>';
	} else {
		$toggle_icons = '<i class="toggle-down fa fa-caret-down"></i><i class="toggle-up fa fa-caret-up"></i>';
	}
	
	return '<div class="themedy-shortcode themedy-shortcode-toggle '.$active_class.'"><h3 class="themedy-shortcode themedy-shortcode-toggle-heading">'.$icon_code.$heading.$toggle_icons.'</h3><div class="themedy-shortcode themedy-shortcode-toggle-content"><p>'.do_shortcode($content).'</p></div></div>';

}
add_shortcode('themedy_toggle', 'themedy_shortcodes_toggle');



/* Accordion */

function themedy_shortcodes_accordion($atts, $content = null) {

	/* Return Toggles */
	return '<div class="themedy-shortcode themedy-shortcode-accordion"><p>'.do_shortcode($content).'</p></div>';
	
}
add_shortcode('themedy_accordion', 'themedy_shortcodes_accordion');



/* Tabs */

function themedy_shortcodes_tabs($atts, $content = null) {
	/* Return Tabs */
	return '<div class="themedy-shortcode themedy-shortcode-tabs">'.do_shortcode($content).'</div>';
}
add_shortcode('themedy_tabs', 'themedy_shortcodes_tabs');


/* Tab */

function themedy_shortcodes_tab($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'label' => ''
	), $atts));
		
	return '<div class="themedy-shortcode themedy-shortcode-tabpane"><div class="themedy-shortcode themedy-shortcode-tab-label">'.$label.'</div>'.wpautop(do_shortcode($content)).'</div>';

}
add_shortcode('themedy_tab', 'themedy_shortcodes_tab');


/* Map */

global $google_map_script_code;
function themedy_shortcodes_map($atts, $content = null) {
	global $google_map_script_code;
	
	/* Set up variables */
	extract(shortcode_atts(array(
		'latitude' => '', 
		'longitude' => '', 
		'width' => '100%', 
		'height' => '400px', 
		'zoom' => '16',
		'infowindow_text' => ''
	), $atts));
		
	$google_map_code = "";
	
	if( strpos($height, 'px') || strpos($height, '%') ) { } else {
		$height = $height.'px';
	}
	if( strpos($width, 'px') || strpos($width, '%') ) { } else {
		$width = $width.'px';
	}
	
	$infowindow_text = '<p>'.$infowindow_text.'</p>';
	
	$content_map_id = "content_map_".rand();
				
		$google_map_script_code .= "<script src='https://maps.googleapis.com/maps/api/js?sensor=false'></script>
		<script type='text/javascript'>
	      jQuery(function() {
	        var myLatlng = new google.maps.LatLng(".$latitude.",".$longitude.");
	        var mapOptions = {
	          zoom: ".$zoom.",
	          center: myLatlng,
	          mapTypeId: google.maps.MapTypeId.ROADMAP
	        }
	
	        var map = new google.maps.Map(document.getElementById('".$content_map_id."'), mapOptions);
	        
	        var marker = new google.maps.Marker({
	            position: myLatlng,
	            map: map,
	            title: ''
	        });";
	        
	if($infowindow_text) {
	
	        $google_map_script_code .= "
	        var contentString = '".$infowindow_text."';
	
	        var infowindow = new google.maps.InfoWindow({
	            content: contentString
	        });
	        
	        google.maps.event.addListener(marker, 'click', function() {
	          infowindow.open(map,marker);
	        });";
	        
	}
	        
	      $google_map_script_code .= " 
	      });
	    </script>";
	    
	    $google_map_code .= '<div id="'.$content_map_id.'" class="themedy-shortcode-map" style="width:'.$width.';height:'.$height.';"></div>';
		
	return $google_map_code;

}
add_shortcode('themedy_map', 'themedy_shortcodes_map');



/* Add Google Map Code to Footer */

function themedy_add_google_map_code() { 
	global $google_map_script_code;
	if(isset($google_map_script_code)) {
		if($google_map_script_code) { 
			echo $google_map_script_code;
		}		
	}
	
}
add_action('wp_footer', 'themedy_add_google_map_code');



/* Alert Box */

function themedy_shortcodes_alertbox($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'icon' => '',
		'colour' => '', 
		'font_awesome_att' => '',
		'custom_colour' => ''
	), $atts));
	
	$icon = check_old_fa($icon);

	$alertbox_style = "";
	if($custom_colour) {
		$alertbox_style = ' style="background-color: '.$custom_colour.'"';
	}
	if($icon) { $icon_code = '<i class="fa '.$font_awesome_att.'fa-'.$icon.'"></i>'; } else { $icon_code = ''; }
	
	return '<div class="themedy-shortcode themedy-shortcode-alertbox themedy-shortcode-alertbox-colour-'.$colour.'"'.$alertbox_style.'><p class="themedy-shortcode themedy-shortcode-alertbox-content">'.$icon_code.do_shortcode($content).'</p></div>';

}
add_shortcode('themedy_alertbox', 'themedy_shortcodes_alertbox');



/* Pull Quote Left */

function themedy_shortcodes_pullleft($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'text' => '',
		'colour' => '', 
		'colour_custom' => ''
	), $atts));
	
	
	$pullleft_style = "";
	if($colour_custom) {
		$pullleft_style = ' style="color: '.$colour_custom.'"';
	}
	
	return '<div class="themedy-shortcode themedy-shortcode-pullleft themedy-shortcode-pullleft-colour-'.$colour.'"'.$pullleft_style.'>'.$text.'</div>';

}
add_shortcode('themedy_pullleft', 'themedy_shortcodes_pullleft');



/* Pull Quote Right */

function themedy_shortcodes_pullright($atts, $content = null) {

	/* Set up variables */
	extract(shortcode_atts(array(
		'text' => '',
		'colour' => '', 
		'colour_custom' => ''
	), $atts));
	
	
	$pullright_style = "";
	if($colour_custom) {
		$pullright_style = ' style="color: '.$colour_custom.'"';
	}
	
	return '<div class="themedy-shortcode themedy-shortcode-pullright themedy-shortcode-pullright-colour-'.$colour.'"'.$pullright_style.'>'.$text.'</div>';

}
add_shortcode('themedy_pullright', 'themedy_shortcodes_pullright');